---
title: "Othman_viz"
output: html_document
---

```{r setup, include=FALSE}

library(tidyverse)
library(readr)
library(janitor)
library(lubridate)


```


```{r cars}

datavis <- read_csv("Datavis.csv")

```

```{r}

#Clean names
datavis <- datavis %>% clean_names()

#Change the literacy rate from character to numeric for all categories (adult, youth, elderly) and sexes
datavis_dbl <- datavis %>%
  mutate(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs = as.numeric(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs),
         	
adult_literacy_rate_population_15_years_female_percent_se_adt_litr_fe_zs = as.numeric(	
adult_literacy_rate_population_15_years_female_percent_se_adt_litr_fe_zs),
adult_literacy_rate_population_15_years_male_percent_se_adt_litr_ma_zs = as.numeric(adult_literacy_rate_population_15_years_male_percent_se_adt_litr_ma_zs),
elderly_literacy_rate_population_65_years_both_sexes_percent_uis_lr_ag65 = as.numeric(elderly_literacy_rate_population_65_years_both_sexes_percent_uis_lr_ag65
),
elderly_literacy_rate_population_65_years_female_percent_uis_lr_ag65_f = as.numeric(elderly_literacy_rate_population_65_years_female_percent_uis_lr_ag65_f
),
elderly_literacy_rate_population_65_years_male_percent_uis_lr_ag65_m = as.numeric(elderly_literacy_rate_population_65_years_male_percent_uis_lr_ag65_m),
youth_literacy_rate_population_15_24_years_both_sexes_percent_se_adt_1524_lt_zs = as.numeric(youth_literacy_rate_population_15_24_years_both_sexes_percent_se_adt_1524_lt_zs),
youth_literacy_rate_population_15_24_years_female_percent_se_adt_1524_lt_fe_zs = as.numeric(youth_literacy_rate_population_15_24_years_female_percent_se_adt_1524_lt_fe_zs
),
youth_literacy_rate_population_15_24_years_male_percent_se_adt_1524_lt_ma_zs = as.numeric(youth_literacy_rate_population_15_24_years_male_percent_se_adt_1524_lt_ma_zs
) )


#I filter for Morocco
datavis_morocco <- datavis_dbl %>%
  filter(country_name == "Morocco")

view(datavis_morocco)

#I filter for 2018 only
datavis_morocco_recent <- datavis_morocco %>%
  filter(time == 2018)

#Mean literacy rate worldwide. Since some countries have NA values, there is a small error
mean_literacy_worldwide <- datavis_dbl %>%
  filter(time == 2018) %>%
  na.omit(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs) %>%
  summarize(mean(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs))

#I add the true literacy rate worldwide to correct for the small error found earlier
datavis_morocco_recent %>%
  mutate(worldwide_literacy_rate = 86.3) %>%
  mutate(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs = as.numeric(adult_literacy_rate_population_15_years_both_sexes_percent_se_adt_litr_zs))

datavis_morocco_recent





```
```{r}
#I create a dataframe for my first visualization 
region <- c('Morocco','World')
adult_literacy_rate <- c(73.75,86.3)
first_plot_df <- data.frame(region,adult_literacy_rate)

#First plot : literacy rate Morocco vs worldwide
ggplot(first_plot_df, aes(x=region,y=adult_literacy_rate,fill=region)) + geom_col() +
  ylim(0,100)+ 
  labs(title = "Morocco is far behind the rest of the world",subtitle ="Adult literacy rate Worldwide vs Morocco", x= "Region", y = "Adult literacy rate", caption = "Source : worldbank.org/education") + 
  theme_minimal() + 
  geom_text(label=percent(adult_literacy_rate/100),vjust = -2.3, family = "Oswald", size=4) +
  scale_fill_manual(values = c("#C0392B","#D5F5E3")) + 
  theme(plot.title = element_text(face = "bold", size = 19, family = "Oswald"),
      legend.title = element_text(family = "Oswald"),
      legend.position = 'none',
      plot.subtitle=element_text(size=17, family = "Oswald"),
      plot.caption = element_text(size=9 , family = "Oswald"),
      axis.text.x = element_text(size= 11, family='Oswald',color="black"),
      axis.text.y = element_text(size= 11,family = "Oswald",color="black"),
      axis.title.x = element_text(size= 11, family='Oswald',color="black"),
      axis.title.y = element_text(size= 11,family = "Oswald",color="black"),plot.title.position = "plot",
       plot.caption.position = "plot")

```
  
  